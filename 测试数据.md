# 用户注册接口测试数据

## 1. 注册接口 - POST /auth/register

### 测试用例1：完整信息注册
```json
{
  "phone": "13800138000",
  "password": "123456",
  "nickname": "张三",
  "avatar": "https://example.com/avatar1.jpg",
  "gender": "1",
  "studentId": "2021001",
  "school": "北京大学",
  "email": "zhangsan@example.com"
}
```

### 测试用例2：最小必填信息注册
```json
{
  "phone": "13900139000",
  "password": "123456",
  "nickname": "李四"
}
```

### 测试用例3：女性用户注册
```json
{
  "phone": "13700137000",
  "password": "password123",
  "nickname": "王五",
  "gender": "2",
  "studentId": "2021002",
  "school": "清华大学"
}
```

### 测试用例4：未知性别用户注册
```json
{
  "phone": "13600136000",
  "password": "abc123456",
  "nickname": "赵六",
  "gender": "0"
}
```

### 错误用例1：手机号为空
```json
{
  "password": "123456",
  "nickname": "测试用户"
}
```
预期错误：`{"code":0,"msg":"手机号不能为空","data":null}`

### 错误用例2：密码为空
```json
{
  "phone": "13800138000",
  "nickname": "测试用户"
}
```
预期错误：`{"code":0,"msg":"密码不能为空","data":null}`

### 错误用例3：昵称为空
```json
{
  "phone": "13800138000",
  "password": "123456"
}
```
预期错误：`{"code":0,"msg":"昵称不能为空","data":null}`

### 错误用例4：手机号格式错误
```json
{
  "phone": "1234567890",
  "password": "123456",
  "nickname": "测试用户"
}
```
预期错误：`{"code":0,"msg":"手机号格式不正确","data":null}`

### 错误用例5：密码长度不足
```json
{
  "phone": "13800138000",
  "password": "12345",
  "nickname": "测试用户"
}
```
预期错误：`{"code":0,"msg":"密码长度必须在6-20位之间","data":null}`

### 错误用例6：手机号已存在
```json
{
  "phone": "13800138000",
  "password": "123456",
  "nickname": "重复用户"
}
```
预期错误：`{"code":0,"msg":"该手机号已被注册","data":null}`

### 错误用例7：性别参数错误
```json
{
  "phone": "13500135000",
  "password": "123456",
  "nickname": "测试用户",
  "gender": "3"
}
```
预期错误：`{"code":0,"msg":"性别参数不正确（0-未知，1-男，2-女）","data":null}`

---

## 2. 用户登录接口 - POST /auth/login

**请求方式：** POST  
**请求URL：** `http://localhost:8080/auth/login`  
**请求头：** `Content-Type: application/json`

### 测试用例1：正常登录
```json
{
  "phone": "13800138000",
  "password": "123456"
}
```

**预期响应：**
```json
{
  "code": 1,
  "msg": null,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "userId": 1,
      "phone": "13800138000",
      "nickname": "张三",
      "avatar": "https://example.com/avatar1.jpg",
      "gender": 1,
      "studentId": "2021001",
      "school": "北京大学",
      "createTime": "2024-01-01 10:00:00",
      "updateTime": "2024-01-01 10:00:00"
    }
  }
}
```

### 错误用例1：手机号为空
```json
{
  "password": "123456"
}
```
预期错误：`{"code":0,"msg":"手机号不能为空","data":null}`

### 错误用例2：密码为空
```json
{
  "phone": "13800138000"
}
```
预期错误：`{"code":0,"msg":"密码不能为空","data":null}`

### 错误用例3：用户不存在
```json
{
  "phone": "99999999999",
  "password": "123456"
}
```
预期错误：`{"code":0,"msg":"手机号或密码错误","data":null}`

### 错误用例4：密码错误
```json
{
  "phone": "13800138000",
  "password": "wrongpassword"
}
```
预期错误：`{"code":0,"msg":"手机号或密码错误","data":null}`

---

## 3. 获取用户信息接口 - GET /auth/profile（需要JWT认证）

**请求方式：** GET  
**请求URL：** `http://localhost:8080/auth/profile`  
**请求头：** `Authorization: Bearer {token}`

**示例：**
```bash
curl -X GET http://localhost:8080/auth/profile \
  -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**预期响应：**
```json
{
  "code": 1,
  "msg": null,
  "data": {
    "userId": 1,
    "phone": "13800138000",
    "nickname": "张三",
    "avatar": "https://example.com/avatar1.jpg",
    "gender": 1,
    "studentId": "2021001",
    "school": "北京大学",
    "createTime": "2024-01-01 10:00:00",
    "updateTime": "2024-01-01 10:00:00"
  }
}
```

**错误用例：未提供token或token无效**
```json
{
  "code": 0,
  "msg": "未登录或token已过期",
  "data": null
}
```

---

## 4. 查询用户列表接口 - GET /auth/query

**请求方式：** GET  
**请求URL：** `http://localhost:8080/auth/query`

**预期响应：**
```json
{
  "code": 1,
  "msg": null,
  "data": [
    {
      "userId": 1,
      "phone": "13800138000",
      "nickname": "张三",
      "avatar": "https://example.com/avatar1.jpg",
      "gender": 1,
      "studentId": "2021001",
      "school": "北京大学",
      "createTime": "2024-01-01 10:00:00",
      "updateTime": "2024-01-01 10:00:00"
    },
    {
      "userId": 2,
      "phone": "13900139000",
      "nickname": "李四",
      "avatar": "https://via.placeholder.com/150",
      "gender": 0,
      "createTime": "2024-01-01 10:00:00",
      "updateTime": "2024-01-01 10:00:00"
    }
  ]
}
```

---

## 5. 根据手机号查询用户接口 - GET /auth/query/{phone}

**请求方式：** GET  
**请求URL：** `http://localhost:8080/auth/query/13800138000`

**预期响应：**
```json
{
  "code": 1,
  "msg": null,
  "data": {
    "userId": 1,
    "phone": "13800138000",
    "nickname": "张三",
    "avatar": "https://example.com/avatar1.jpg",
    "gender": 1,
    "studentId": "2021001",
    "school": "北京大学",
    "createTime": "2024-01-01 10:00:00",
    "updateTime": "2024-01-01 10:00:00"
  }
}
```

**错误用例：** 查询不存在的用户
**请求URL：** `http://localhost:8080/auth/query/99999999999`

**预期响应：**
```json
{
  "code": 0,
  "msg": "用户不存在",
  "data": null
}
```

---

## 使用curl命令测试

### 注册接口
```bash
curl -X POST http://localhost:8080/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13800138000",
    "password": "123456",
    "nickname": "张三",
    "gender": "1",
    "studentId": "2021001",
    "school": "北京大学"
  }'
```

### 登录接口
```bash
curl -X POST http://localhost:8080/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13800138000",
    "password": "123456"
  }'
```

### 获取用户信息（需要token）
```bash
curl -X GET http://localhost:8080/auth/profile \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

### 查询用户列表
```bash
curl -X GET http://localhost:8080/auth/query
```

### 根据手机号查询用户
```bash
curl -X GET http://localhost:8080/auth/query/13800138000
```

---

## 字段说明

- **phone**: 手机号（必填，11位数字，1开头）
- **password**: 密码（必填，6-20位）
- **nickname**: 昵称（必填）
- **avatar**: 头像URL（可选，默认：https://via.placeholder.com/150）
- **gender**: 性别（可选，0-未知，1-男，2-女，默认：0）
- **studentId**: 学号（可选）
- **school**: 学校（可选）
- **email**: 邮箱（可选）

## 注意事项

1. **密码加密**：密码使用MD5加密存储
2. **事务管理**：注册接口使用事务管理，任何异常都会回滚
3. **密码安全**：查询接口返回的数据中不包含密码字段
4. **时间格式**：所有时间字段格式：yyyy-MM-dd HH:mm:ss
5. **JWT认证**：
   - 登录成功后返回JWT token
   - token默认有效期为24小时（可在application.yml中配置）
   - 需要认证的接口需要在请求头中携带：`Authorization: Bearer {token}`
   - 以下接口不需要认证：注册、登录、查询用户列表、根据手机号查询用户
   - 以下接口需要认证：获取用户信息、修改用户信息等
6. **JWT配置**：在`application.yml`中可以配置JWT密钥和过期时间

